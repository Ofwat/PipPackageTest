<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>dqchecks package &#8212; dqchecks  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dqchecks-package">
<h1>dqchecks package<a class="headerlink" href="#dqchecks-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-dqchecks.panacea">
<span id="dqchecks-panacea-module"></span><h2>dqchecks.panacea module<a class="headerlink" href="#module-dqchecks.panacea" title="Link to this heading">¶</a></h2>
<p>Panacea code</p>
<p>Function used to do initial validation of the Excel files</p>
<dl class="py class">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaDifferencesContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">FormulaDifferencesContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rule_Cd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sheet_Cd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Severity_Cd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.FormulaDifferencesContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaDifferencesContext.Error_Category">
<span class="sig-name descname"><span class="pre">Error_Category</span></span><a class="headerlink" href="#dqchecks.panacea.FormulaDifferencesContext.Error_Category" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaDifferencesContext.Error_Severity_Cd">
<span class="sig-name descname"><span class="pre">Error_Severity_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.FormulaDifferencesContext.Error_Severity_Cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaDifferencesContext.Rule_Cd">
<span class="sig-name descname"><span class="pre">Rule_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.FormulaDifferencesContext.Rule_Cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaDifferencesContext.Sheet_Cd">
<span class="sig-name descname"><span class="pre">Sheet_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.FormulaDifferencesContext.Sheet_Cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaErrorSheetContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">FormulaErrorSheetContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rule_Cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sheet_Cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Severity_Cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.FormulaErrorSheetContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>A NamedTuple representing the context of a formula error on a worksheet.</p>
<p>This class holds information related to the formula error in a worksheet,
including details such as the rule code, sheet code, error category,
and error severity code.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaErrorSheetContext.Rule_Cd">
<span class="sig-name descname"><span class="pre">Rule_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.FormulaErrorSheetContext.Rule_Cd" title="Link to this definition">¶</a></dt>
<dd><p>The code of the rule associated with the error.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaErrorSheetContext.Sheet_Cd">
<span class="sig-name descname"><span class="pre">Sheet_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.FormulaErrorSheetContext.Sheet_Cd" title="Link to this definition">¶</a></dt>
<dd><p>The code of the sheet where the error occurred.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaErrorSheetContext.Error_Category">
<span class="sig-name descname"><span class="pre">Error_Category</span></span><a class="headerlink" href="#dqchecks.panacea.FormulaErrorSheetContext.Error_Category" title="Link to this definition">¶</a></dt>
<dd><p>The category of the error (e.g., syntax, reference).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaErrorSheetContext.Error_Severity_Cd">
<span class="sig-name descname"><span class="pre">Error_Severity_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.FormulaErrorSheetContext.Error_Severity_Cd" title="Link to this definition">¶</a></dt>
<dd><p>The severity code of the error (e.g., high, medium, low).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">Error_Category</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">Error_Severity_Cd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">Rule_Cd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">Sheet_Cd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id3" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaErrorSheetContext.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dqchecks.panacea.FormulaErrorSheetContext.to_dict" title="Link to this definition">¶</a></dt>
<dd><p>Converts the FormulaErrorSheetContext instance to a dictionary.</p>
<p>This method returns the fields of the FormulaErrorSheetContext
as key-value pairs in a dictionary, where the keys correspond to
the attribute names and the values correspond to the attribute values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary representation of the FormulaErrorSheetContext instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, str]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>{</dt><dd><p>‘Rule_Cd’: ‘RULE123’,
‘Sheet_Cd’: ‘Sheet1’,
‘Error_Category’: ‘Formula Error’,
‘Error_Severity_Cd’: ‘High’</p>
</dd>
</dl>
<p>}</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dqchecks.panacea.FormulaErrorSheetContext.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dqchecks.panacea.FormulaErrorSheetContext.validate" title="Link to this definition">¶</a></dt>
<dd><p>Validates the fields of the FormulaErrorSheetContext NamedTuple.</p>
<p>This method checks that all attributes of the FormulaErrorSheetContext
(Rule_Cd, Sheet_Cd, Error_Category, Error_Severity_Cd) are of type ‘str’.
If any attribute does not meet this condition, a ValueError is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If any attribute is not of type ‘str’ or is empty.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">MissingSheetContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rule_Cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Severity_Cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.MissingSheetContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>A class representing the context of a missing sheet error.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetContext.Rule_Cd">
<span class="sig-name descname"><span class="pre">Rule_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetContext.Rule_Cd" title="Link to this definition">¶</a></dt>
<dd><p>The code representing the rule associated with the missing sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetContext.Error_Category">
<span class="sig-name descname"><span class="pre">Error_Category</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetContext.Error_Category" title="Link to this definition">¶</a></dt>
<dd><p>The category of the error related to the missing sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetContext.Error_Severity_Cd">
<span class="sig-name descname"><span class="pre">Error_Severity_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetContext.Error_Severity_Cd" title="Link to this definition">¶</a></dt>
<dd><p>The severity code of the error for the missing sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p>This class is used to provide structured information about errors related to missing sheets,
including details about the rule, error category, and severity.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">Error_Category</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id4" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">Error_Severity_Cd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id5" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">Rule_Cd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id6" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetContext.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetContext.validate" title="Link to this definition">¶</a></dt>
<dd><p>Helper method to validate the context fields.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">MissingSheetRow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Event_Id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sheet_Cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rule_Cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Severity_Cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>A class representing a row of information for a missing sheet error.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow.Event_Id">
<span class="sig-name descname"><span class="pre">Event_Id</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow.Event_Id" title="Link to this definition">¶</a></dt>
<dd><p>A unique identifier for the event.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow.Sheet_Cd">
<span class="sig-name descname"><span class="pre">Sheet_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow.Sheet_Cd" title="Link to this definition">¶</a></dt>
<dd><p>The code representing the missing sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow.Rule_Cd">
<span class="sig-name descname"><span class="pre">Rule_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow.Rule_Cd" title="Link to this definition">¶</a></dt>
<dd><p>The code representing the rule associated with the missing sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow.Error_Category">
<span class="sig-name descname"><span class="pre">Error_Category</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow.Error_Category" title="Link to this definition">¶</a></dt>
<dd><p>The category of the error related to the missing sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow.Error_Severity_Cd">
<span class="sig-name descname"><span class="pre">Error_Severity_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow.Error_Severity_Cd" title="Link to this definition">¶</a></dt>
<dd><p>The severity code of the error for the missing sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow.Error_Desc">
<span class="sig-name descname"><span class="pre">Error_Desc</span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow.Error_Desc" title="Link to this definition">¶</a></dt>
<dd><p>A description of the error (e.g., “Missing Sheet”).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p>This class is used to provide structured information about errors related to missing sheets,
including the event details, rule, error category, severity, and description.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">Error_Category</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id7" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">Error_Desc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id8" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">Error_Severity_Cd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id9" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">Event_Id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id10" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">Rule_Cd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id11" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">Sheet_Cd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id12" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow.to_dict" title="Link to this definition">¶</a></dt>
<dd><p>Converts the MissingSheetRow instance to a dictionary.</p>
<p>This method returns the fields of the MissingSheetRow as key-value pairs in a dictionary,
which can be useful for serialization, logging, or data storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A dictionary representation of the MissingSheetRow, where the keys</dt><dd><p>correspond to the field names and the values correspond to the
field values of the instance.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, str]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>{</dt><dd><p>‘Event_Id’: ‘12345’,
‘Sheet_Cd’: ‘Sheet1’,
‘Rule_Cd’: ‘Rule1’,
‘Error_Category’: ‘Data’,
‘Error_Severity_Cd’: ‘High’,
‘Error_Desc’: ‘Missing Sheet’</p>
</dd>
</dl>
<p>}</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dqchecks.panacea.MissingSheetRow.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dqchecks.panacea.MissingSheetRow.validate" title="Link to this definition">¶</a></dt>
<dd><p>Helper method to validate the context fields.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dqchecks.panacea.StructureDiscrepancyContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">StructureDiscrepancyContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rule_Cd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sheet_Cd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Error_Severity_Cd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.StructureDiscrepancyContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.StructureDiscrepancyContext.Error_Category">
<span class="sig-name descname"><span class="pre">Error_Category</span></span><a class="headerlink" href="#dqchecks.panacea.StructureDiscrepancyContext.Error_Category" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.StructureDiscrepancyContext.Error_Severity_Cd">
<span class="sig-name descname"><span class="pre">Error_Severity_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.StructureDiscrepancyContext.Error_Severity_Cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.StructureDiscrepancyContext.Rule_Cd">
<span class="sig-name descname"><span class="pre">Rule_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.StructureDiscrepancyContext.Rule_Cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.StructureDiscrepancyContext.Sheet_Cd">
<span class="sig-name descname"><span class="pre">Sheet_Cd</span></span><a class="headerlink" href="#dqchecks.panacea.StructureDiscrepancyContext.Sheet_Cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dqchecks.panacea.UsedArea">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">UsedArea</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">empty_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_used_row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_used_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.UsedArea" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>A NamedTuple representing the used area of a worksheet.</p>
<p>This class holds information about the used area of a worksheet, including the number of
empty rows at the bottom, the number of empty columns on the right, and the last non-empty
row and column in the worksheet.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.UsedArea.empty_rows">
<span class="sig-name descname"><span class="pre">empty_rows</span></span><a class="headerlink" href="#dqchecks.panacea.UsedArea.empty_rows" title="Link to this definition">¶</a></dt>
<dd><p>The number of empty rows at the bottom of the sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.UsedArea.empty_columns">
<span class="sig-name descname"><span class="pre">empty_columns</span></span><a class="headerlink" href="#dqchecks.panacea.UsedArea.empty_columns" title="Link to this definition">¶</a></dt>
<dd><p>The number of empty columns on the right of the sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.UsedArea.last_used_row">
<span class="sig-name descname"><span class="pre">last_used_row</span></span><a class="headerlink" href="#dqchecks.panacea.UsedArea.last_used_row" title="Link to this definition">¶</a></dt>
<dd><p>The last non-empty row in the sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.panacea.UsedArea.last_used_column">
<span class="sig-name descname"><span class="pre">last_used_column</span></span><a class="headerlink" href="#dqchecks.panacea.UsedArea.last_used_column" title="Link to this definition">¶</a></dt>
<dd><p>The last non-empty column in the sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">empty_columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id13" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">empty_rows</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id14" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">last_used_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id15" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">last_used_row</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id16" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dqchecks.panacea.UsedArea.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dqchecks.panacea.UsedArea.to_dict" title="Link to this definition">¶</a></dt>
<dd><p>Converts the UsedArea instance to a dictionary.</p>
<p>This method returns the fields of the UsedArea instance as key-value pairs in a dictionary,
which can be useful for serialization, logging, or further data processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A dictionary representation of the UsedArea instance, with the keys</dt><dd><p>corresponding to the field names and the values corresponding to the
field values of the instance.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, int]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>{</dt><dd><p>‘empty_rows’: 5,
‘empty_columns’: 2,
‘last_used_row’: 50,
‘last_used_column’: 20</p>
</dd>
</dl>
<p>}</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dqchecks.panacea.UsedArea.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dqchecks.panacea.UsedArea.validate" title="Link to this definition">¶</a></dt>
<dd><p>Validates the fields of the UsedArea NamedTuple to ensure they are integers.</p>
<p>This method checks that all attributes of the UsedArea (empty_rows, empty_columns,
last_used_row, last_used_column) are of type ‘int’. If any attribute does not meet
this condition, a ValueError is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If any attribute is not of type ‘int’.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.check_for_nulls_and_duplicates">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">check_for_nulls_and_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worksheet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_row_after_header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">working_area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.panacea.UsedArea" title="dqchecks.panacea.UsedArea"><span class="pre">UsedArea</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.check_for_nulls_and_duplicates" title="Link to this definition">¶</a></dt>
<dd><p>Check for null values and duplicate values in a specific column of the worksheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>worksheet</strong> (<em>openpyxl.worksheet.worksheet.Worksheet</em>) – The worksheet to check.</p></li>
<li><p><strong>column_index</strong> (<em>int</em>) – The index of the column to check for null and duplicate values.</p></li>
<li><p><strong>skip_rows</strong> (<em>int</em>) – The number of rows to skip at the beginning.</p></li>
<li><p><strong>skip_row_after_header</strong> (<em>int</em>) – The row to skip immediately after the header.</p></li>
<li><p><strong>working_area</strong> (<em>dict</em>) – Output from get_used_area function for given sheet.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>A list of rows where null values were found.</p></li>
<li><p>A dictionary where keys are duplicate values and values are lists of rows containing those duplicates.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.check_formula_errors">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">check_formula_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.check_formula_errors" title="Link to this definition">¶</a></dt>
<dd><p>Checks for formula errors in a given openpyxl worksheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sheet</strong> (<em>openpyxl.worksheet.worksheet.Worksheet</em>) – The worksheet to check for formula errors.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>A dictionary with status, description, and any found errors in the format:</dt><dd><dl>
<dt>{</dt><dd><p>“status”: “Error”,
“description”: “Found errors”,
“errors”: {</p>
<blockquote>
<div><p>”#DIV/0!”: [“Sheet1!A1”]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}
or {“status”: “Ok”} if no errors were found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>sheet = workbook[‘Sheet1’]
result = check_formula_errors(sheet)
print(result)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.check_pk_for_nulls_and_duplicates">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">check_pk_for_nulls_and_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workbook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name_pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_column_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_row_after_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dqchecks.panacea.check_pk_for_nulls_and_duplicates" title="Link to this definition">¶</a></dt>
<dd><p>Checks each worksheet in the provided workbook for null (None) values and duplicates in the specified column.
This function examines all sheets matching a given regex pattern, checks for null values in the specified column,
and identifies duplicate values in that column. It then compiles and returns the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workbook</strong> (<em>openpyxl.Workbook</em>) – The workbook to check, containing multiple sheets.</p></li>
<li><p><strong>sheet_name_pattern</strong> (<em>str</em>) – A regular expression pattern to filter sheet names. Only sheets whose names match
this pattern will be checked.</p></li>
<li><p><strong>header_column_name</strong> (<em>str</em>) – The name of the header in the second row that indicates the column to check for nulls
and duplicates.</p></li>
<li><p><strong>skip_rows</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of rows to skip at the beginning of each sheet before checking the data.
Default is 0 (no rows skipped).</p></li>
<li><p><strong>skip_row_after_header</strong> (<em>int</em><em>, </em><em>optional</em>) – The row after the header that should be skipped when checking for null values.
Default is 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary containing the following keys:</dt><dd><ul class="simple">
<li><p>”status” (str): “Ok” if no issues are found, “Error” if issues with null values or duplicates exist.</p></li>
<li><p>”description” (str): A general description, either “No issues with keys.” or “Issues in primary keys.”</p></li>
<li><dl class="simple">
<dt>”errors” (dict): A dictionary containing detailed errors for each sheet, including:</dt><dd><ul>
<li><p>”null_rows” (list): A list of rows where null values were found in the specified column.</p></li>
<li><p>”duplicate_rows” (dict): A dictionary where keys are duplicate values and values are lists of rows
containing the duplicate value.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”meta” (dict): A dictionary containing metadata, such as the header column name.</dt><dd><ul>
<li><p>”header_column_name” (str): The name of the header column being checked.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>result = check_pk_for_nulls_and_duplicates(workbook, sheet_name_pattern=”Sheet*”, header_column_name=”ID”)
print(result)
# Returns a dictionary with ‘status’, ‘description’, ‘errors’ (nulls and duplicates), and ‘meta’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.check_sheet_structure">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">check_sheet_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Worksheet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Worksheet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_row_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.check_sheet_structure" title="Link to this definition">¶</a></dt>
<dd><p>Compares the structure of two openpyxl worksheet objects to determine
if they have the same number of rows, columns, and column headers.</p>
<p>This function validates whether the two worksheet objects are of the correct type, checks for
any empty sheets, compares the number of rows and columns, and ensures that the column headers
(both name and order) are the same in both sheets.
It will return a detailed report indicating any discrepancies found
between the two sheets’ structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet1</strong> (<em>openpyxl.worksheet.worksheet.Worksheet</em>) – The first worksheet object to compare.</p></li>
<li><p><strong>sheet2</strong> (<em>openpyxl.worksheet.worksheet.Worksheet</em>) – The second worksheet object to compare.</p></li>
<li><p><strong>header_row_number</strong> (<em>int</em><em>, </em><em>optional</em>) – The row number (1-based index) containing the</p></li>
<li><p><strong>0</strong> (<em>column headers to compare. Defaults to</em>)</p></li>
<li><p><strong>made.</strong> (<em>which means no header comparison will be</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>A dictionary containing the following structure:</dt><dd><ul class="simple">
<li><p>”status” (str): Either “Error” if discrepancies were found, or “Ok”</p></li>
</ul>
<p>if the structure is identical.
- “description” (str): A message describing the result, either listing
discrepancies or confirming the match.
- “errors” (dict): A dictionary with error details if discrepancies are found.
It contains error categories (e.g., “Row/Column Count”, “Empty Sheet”,
“Header Mismatch”) and lists specific issues under each category.
If no discrepancies are found, this is an empty dictionary.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>sheet1 = workbook1[‘Sheet1’]
sheet2 = workbook2[‘Sheet2’]
result = check_sheet_structure(sheet1, sheet2)
print(result)</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>An empty sheet is defined as one that has no rows or columns with data.</p></li>
<li><p>Column header comparison is case-sensitive and checks for exact matches</p></li>
</ul>
<p>in both name and order.
- If <cite>header_row_number</cite> is set to 0, the function will skip column header comparison.
- The function compares the maximum number of rows and columns
(<cite>max_row</cite> and <cite>max_column</cite>) of the sheets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.check_value_in_cell">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">check_value_in_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workbook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'B5'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dqchecks.panacea.check_value_in_cell" title="Link to this definition">¶</a></dt>
<dd><p>Checks if a given value exists in a specific cell
within a specified sheet in an openpyxl workbook.</p>
<p>This function checks whether the value in a given cell of a
specified worksheet matches the provided value.
It handles cases where the sheet is missing or the value does not match
the expected value in the specified cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workbook</strong> (<em>openpyxl.Workbook</em>) – The workbook to check, which contains multiple sheets.</p></li>
<li><p><strong>sheet_name</strong> (<em>str</em>) – The name of the sheet within the workbook where the cell will be checked.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The value to check for in the specified cell.
This can be a string, integer, float, or boolean.</p></li>
<li><p><strong>cell_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the cell to check, default is “B5”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>A dictionary containing the result of the check.</dt><dd><p>The dictionary will have the following structure:
- If the value is found:</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“status”: “Ok”,
“description”: “Value found in cell”,
“errors”: {},
“meta”: {</p>
<blockquote>
<div><p>”sheet_name”: “Sheet1”,
“cell_name”: “B5”</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<ul>
<li><p>If the value does not match:
{</p>
<blockquote>
<div><p>”status”: “Error”,
“description”: “Value mismatch”,
“errors”: {</p>
<blockquote>
<div><p>”B5”: [“Expected [value] found [cell_value]”]</p>
</div></blockquote>
<p>},
“meta”: {</p>
<blockquote>
<div><p>”sheet_name”: “Sheet1”,
“cell_name”: “B5”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>}</p>
</li>
<li><p>If the sheet does not exist:
{</p>
<blockquote>
<div><p>”status”: “Error”,
“description”: “Missing sheet”,
“errors”: [“Sheet ‘SheetName’ not found in the workbook”],
“meta”: {</p>
<blockquote>
<div><p>”sheet_name”: “Sheet1”,
“cell_name”: “B5”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>}</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If ‘workbook’ is not an openpyxl Workbook, ‘sheet_name’ is not a string,
    ‘value’ is not a valid type, or ‘cell_name’ is not a valid cell reference.</p></li>
<li><p><strong>KeyError</strong> – If the cell name is invalid or doesn’t exist in the specified sheet.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p># Example usage:
result = check_value_in_cell(workbook, “Sheet1”, “TestValue”, “B2”)
print(result)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.compare_formulas">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">compare_formulas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.compare_formulas" title="Link to this definition">¶</a></dt>
<dd><p>Compares the formulas between two openpyxl worksheet objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet1</strong> (<em>openpyxl.worksheet.worksheet.Worksheet</em>) – The first worksheet to compare.</p></li>
<li><p><strong>sheet2</strong> (<em>openpyxl.worksheet.worksheet.Worksheet</em>) – The second worksheet to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>A dictionary with status, description, and any differences:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>If formulas are equivalent: {</dt><dd><p>“status”: “Ok”,
“description”: “All formulas are equivalent”,
“errors”: {}</p>
</dd>
</dl>
</li>
</ul>
<p>}
- If formulas differ: {</p>
<blockquote>
<div><p>”status”: “Error”,
“description”: “Found formula differences”,
“errors”: {</p>
<blockquote>
<div><p>”Cell_Name”: [“Sheet1!A1”]
}</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.create_dataframe_formula_differences">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">create_dataframe_formula_differences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.panacea.FormulaDifferencesContext" title="dqchecks.panacea.FormulaDifferencesContext"><span class="pre">FormulaDifferencesContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dqchecks.panacea.create_dataframe_formula_differences" title="Link to this definition">¶</a></dt>
<dd><p>Creates a DataFrame from input data containing formula discrepancies for a specific sheet.</p>
<p>This function processes input data containing formula discrepancies
(such as errors in formulas or missing references) and converts
it into a pandas DataFrame. Each discrepancy will be represented as a row
in the DataFrame, along with associated metadata (such as the rule code,
sheet code, error category, severity, and error description).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>dict</em>) – A dictionary containing errors (keyed by cell reference)
that occurred in the sheet. The value should be a list of error descriptions
for each cell.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#dqchecks.panacea.FormulaDifferencesContext" title="dqchecks.panacea.FormulaDifferencesContext"><em>FormulaDifferencesContext</em></a>) – A namedtuple containing contextual information about the discrepancy,
including Rule_Cd, Sheet_Cd, Error_Category, and Error_Severity_Cd.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas DataFrame containing the formula discrepancies. Each row represents
a discrepancy with details including the event ID, sheet name, rule code,
cell reference, error category, severity, and description.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the <cite>input_data</cite> is not a dictionary or if the <cite>context</cite> is
not a valid <cite>FormulaDifferencesContext</cite>.</p></li>
<li><p><strong>KeyError</strong> – If any expected key is missing in <cite>input_data</cite>.</p></li>
<li><p><strong>TypeError</strong> – If the values in <cite>input_data</cite> are not lists or if any item in the
list is not iterable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.create_dataframe_formula_errors">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">create_dataframe_formula_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.panacea.FormulaErrorSheetContext" title="dqchecks.panacea.FormulaErrorSheetContext"><span class="pre">FormulaErrorSheetContext</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.create_dataframe_formula_errors" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Creates a pandas DataFrame representing formula errors</dt><dd><p>based on the input error data and context.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>dict</em>) – A dictionary containing error details, where the keys
are error types and the values are lists of cell references
affected by the errors.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#dqchecks.panacea.FormulaErrorSheetContext" title="dqchecks.panacea.FormulaErrorSheetContext"><em>FormulaErrorSheetContext</em></a>) – A namedtuple containing error details
like Rule_Cd, Sheet_Cd, Error_Category, and Error_Severity_Cd.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing the rows for formula errors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If ‘input_data’ is not a dictionary or if ‘context’ is invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.create_dataframe_from_company_selection_check">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">create_dataframe_from_company_selection_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dqchecks.panacea.create_dataframe_from_company_selection_check" title="Link to this definition">¶</a></dt>
<dd><p>Creates a pandas DataFrame based on the output of a value check(e.g., ‘check_value_in_b2’) function.
This function processes errors returned from the check and structures them into a DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_data</strong> (<em>dict</em>) – <p>The output data from a value check function, which contains:
- ‘status’ (str): A string indicating whether the value matches or not (e.g., “Ok” or “Error”).
- ‘description’ (str): A description of the result.
- ‘errors’ (list): A list of error messages (if any) related to value mismatches.
- ‘meta’ (dict): A dictionary containing metadata with the following keys:</p>
<blockquote>
<div><ul class="simple">
<li><p>’sheet_name’ (str): Name of the sheet where the error occurred.</p></li>
<li><p>’cell_name’ (str): The name of the cell where the error occurred.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A DataFrame representing the errors, with columns for event ID, sheet name, cell reference,</dt><dd><p>error category, error severity, and error description.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If ‘input_data’ is not a dictionary or does not contain the required keys.</p></li>
<li><p><strong>ValueError</strong> – If ‘errors’ is not a list or is empty.</p></li>
<li><p><strong>KeyError</strong> – If expected keys in ‘input_data’ (such as ‘meta’, ‘sheet_name’, or ‘cell_name’) are missing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.create_dataframe_missing_sheets">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">create_dataframe_missing_sheets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.panacea.MissingSheetContext" title="dqchecks.panacea.MissingSheetContext"><span class="pre">MissingSheetContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dqchecks.panacea.create_dataframe_missing_sheets" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Creates a pandas DataFrame representing missing sheets based on</dt><dd><p>the provided input data and context.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>dict</em>) – The input data containing error details, specifically
the list of missing sheets.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#dqchecks.panacea.MissingSheetContext" title="dqchecks.panacea.MissingSheetContext"><em>MissingSheetContext</em></a>) – The context containing error details such as
Rule_Cd, Error_Category, and Error_Severity_Cd.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing the rows for missing sheets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If ‘input_data’ is not a dictionary or does not contain
    the required ‘errors’ key.</p></li>
<li><p><strong>ValueError</strong> – If ‘context’ is not a valid MissingSheetContext.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.create_dataframe_structure_discrepancies">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">create_dataframe_structure_discrepancies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.panacea.StructureDiscrepancyContext" title="dqchecks.panacea.StructureDiscrepancyContext"><span class="pre">StructureDiscrepancyContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dqchecks.panacea.create_dataframe_structure_discrepancies" title="Link to this definition">¶</a></dt>
<dd><p>Creates a DataFrame representing structure discrepancies
between rows and columns in an Excel sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_data</strong> – A dictionary containing the error data with keys</p>
</dd>
</dl>
<p>as error types and values as the discrepancies.
:type input_data: dict
:param context: The context that contains information
like Rule Code, Sheet Code, Error Category, and Error Severity.
:type context: StructureDiscrepancyContext</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A pandas DataFrame that represents the structure discrepancies for further processing.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If ‘input_data’ does not contain the expected structure</p>
</dd>
</dl>
<p>or if the ‘context’ is invalid.
:raises TypeError: If ‘input_data’ is not a dictionary or ‘context’ is
not an instance of <cite>StructureDiscrepancyContext</cite>.</p>
<p>This function processes the given input data (discrepancies between row/column counts)
and generates a DataFrame with relevant details including
a unique event ID for each discrepancy.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.create_missing_sheet_row">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">create_missing_sheet_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.panacea.MissingSheetContext" title="dqchecks.panacea.MissingSheetContext"><span class="pre">MissingSheetContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dqchecks.panacea.MissingSheetRow" title="dqchecks.panacea.MissingSheetRow"><span class="pre">MissingSheetRow</span></a></span></span><a class="headerlink" href="#dqchecks.panacea.create_missing_sheet_row" title="Link to this definition">¶</a></dt>
<dd><p>Creates a dictionary representing a row for a missing sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet</strong> (<em>str</em>) – The name or identifier of the missing sheet.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#dqchecks.panacea.MissingSheetContext" title="dqchecks.panacea.MissingSheetContext"><em>MissingSheetContext</em></a>) – The context containing error details like
Rule_Cd, Error_Category, and Error_Severity_Cd.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the details of the missing sheet.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If ‘sheet’ is not a string, if ‘context’ does not contain
    the required fields, or if ‘context’ validation fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.create_row_for_error">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">create_row_for_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet_cd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.panacea.FormulaErrorSheetContext" title="dqchecks.panacea.FormulaErrorSheetContext"><span class="pre">FormulaErrorSheetContext</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.create_row_for_error" title="Link to this definition">¶</a></dt>
<dd><p>Creates a row dictionary for a single formula error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet_cd</strong> (<em>str</em>) – The sheet code.</p></li>
<li><p><strong>error_type</strong> (<em>str</em>) – The type of error (e.g., #DIV/0!).</p></li>
<li><p><strong>cell</strong> (<em>str</em>) – The cell reference where the error occurred.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#dqchecks.panacea.FormulaErrorSheetContext" title="dqchecks.panacea.FormulaErrorSheetContext"><em>FormulaErrorSheetContext</em></a>) – The context with error details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary representing a row for the error.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.extract_error_rows">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">extract_error_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.extract_error_rows" title="Link to this definition">¶</a></dt>
<dd><p>Extracts error rows from the input data, validating the ‘errors’ field and its contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_data</strong> (<em>dict</em>) – The input error data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of tuples where each tuple contains the error type and a list of cells.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.find_formula_differences">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">find_formula_differences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb_template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb_company</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dqchecks.panacea.find_formula_differences" title="Link to this definition">¶</a></dt>
<dd><p>Compares the formulas between two workbooks (template and company) and identifies discrepancies.</p>
<p>This function iterates through the sheets common to both workbooks and compares the formulas
between the sheets of the template and company workbooks. It generates a DataFrame containing
all formula differences (if any), including the sheet name, error category, and severity, and
concatenates these into a single DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wb_template</strong> (<em>openpyxl.Workbook</em>) – The template workbook to compare against.</p></li>
<li><p><strong>wb_company</strong> (<em>openpyxl.Workbook</em>) – The company workbook to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing all the formula differences found between the two workbooks.
Each row represents a formula discrepancy with details such as sheet name,
error category, severity, and formula description.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If the input workbooks are not instances of <cite>openpyxl.Workbook</cite>.</p></li>
<li><p><strong>ValueError</strong> – If either of the workbooks does not contain any sheets.</p></li>
<li><p><strong>Exception</strong> – If an error occurs during the formula comparison process.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.find_formula_errors">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">find_formula_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.find_formula_errors" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Finds formula errors across all sheets in an Excel workbook</dt><dd><p>and returns a consolidated DataFrame.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wb</strong> (<em>Workbook</em>) – The openpyxl Workbook object representing the Excel file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing the formula errors from all sheets in the workbook.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the ‘wb’ argument is not an instance of openpyxl Workbook.</p>
</dd>
</dl>
<dl class="simple">
<dt>This function loops through all sheets in the provided workbook,</dt><dd><p>runs formula checks on each sheet,</p>
</dd>
<dt>creates a context for each sheet’s errors, and generates</dt><dd><p>a DataFrame of formula errors. The individual</p>
</dd>
<dt>DataFrames are then concatenated to produce one</dt><dd><p>final DataFrame that contains all the formula errors from</p>
</dd>
</dl>
<p>all sheets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.find_missing_sheets">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">find_missing_sheets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb_template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb_company</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.find_missing_sheets" title="Link to this definition">¶</a></dt>
<dd><p>Finds missing sheets between two provided openpyxl workbooks and returns a DataFrame
representing the missing sheets based on the comparison of the workbooks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wb_template</strong> (<em>openpyxl.workbook</em>) – The template workbook.</p></li>
<li><p><strong>wb_company</strong> (<em>openpyxl.workbook</em>) – The company workbook.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing rows for missing sheets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If either ‘wb_template’ or ‘wb_company’ are not valid openpyxl workbooks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.find_pk_errors">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">find_pk_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workbook</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name_pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_column_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_row_after_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dqchecks.panacea.find_pk_errors" title="Link to this definition">¶</a></dt>
<dd><p>Constructs a pandas DataFrame from the ‘errors’ object of the check_pk_for_nulls_and_duplicates function.
This function calls the check_pk_for_nulls_and_duplicates function to gather error information about missing
values (nulls) and duplicates in the specified column across multiple sheets, and organizes this information
into a structured pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workbook</strong> (<em>openpyxl.Workbook</em>) – The workbook to check, containing multiple sheets.</p></li>
<li><p><strong>sheet_name_pattern</strong> (<em>str</em>) – A regular expression pattern to filter the sheet names to be checked.
Only sheets whose names match this pattern will be included in the check.</p></li>
<li><p><strong>header_column_name</strong> (<em>str</em>) – The name of the header in the second row that identifies the column to check for nulls
and duplicates.</p></li>
<li><p><strong>skip_rows</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of rows to skip at the beginning of each sheet before starting to check the data.
Default is 0 (no rows skipped).</p></li>
<li><p><strong>skip_row_after_header</strong> (<em>int</em><em>, </em><em>optional</em>) – The row after the header that should be skipped when checking for null values.
Default is 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A pandas DataFrame containing the detailed error information about the rows with missing or duplicate</dt><dd><p>values. Each row in the DataFrame corresponds to an error found and includes the following columns:
- ‘Event_Id’: A unique identifier for each error (UUID).
- ‘Sheet_Cd’: The name of the sheet where the error was found.
- ‘Rule_Cd’: A code representing the rule for the error (e.g., “Rule 5: Boncode Repetition”).
- ‘Error_Category’: The type of error, such as “Missing Values” or “Duplicate Value”.
- ‘Error_Severity_Cd’: A placeholder value for error severity (currently “?”).
- ‘Error_Desc’: A description of the error, including the rows with the missing or duplicate value.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>result = find_pk_errors(workbook, sheet_name_pattern=”Sheet*”, header_column_name=”ID”)
print(result)
# Returns a pandas DataFrame with rows containing details of missing or duplicate values in the ‘ID’ column for sheets
# whose names match the “Sheet*” pattern.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function relies on the check_pk_for_nulls_and_duplicates function to gather errors related to missing and
duplicate values in the specified column.</p></li>
<li><p>If no errors are found, the returned DataFrame will be empty.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.find_shape_differences">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">find_shape_differences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb_template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb_company</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dqchecks.panacea.find_shape_differences" title="Link to this definition">¶</a></dt>
<dd><p>Compares the sheet structures between two workbooks (template and company)
and identifies discrepancies.</p>
<p>This function checks if the sheet names exist in both workbooks, compares
the structures, and returns a DataFrame that highlights the discrepancies
found in the structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wb_template</strong> (<em>openpyxl.Workbook</em>) – The template workbook to compare against.</p></li>
<li><p><strong>wb_company</strong> (<em>openpyxl.Workbook</em>) – The company workbook to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing the structure discrepancies found
between the two workbooks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the provided workbooks are not valid or do not
contain any sheets.</p></li>
<li><p><strong>TypeError</strong> – If the input workbooks are not instances of
<cite>openpyxl.Workbook</cite>.</p></li>
<li><p><strong>KeyError</strong> – If a sheet does not exist in one of the workbooks.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.get_used_area">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">get_used_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Worksheet</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dqchecks.panacea.UsedArea" title="dqchecks.panacea.UsedArea"><span class="pre">UsedArea</span></a></span></span><a class="headerlink" href="#dqchecks.panacea.get_used_area" title="Link to this definition">¶</a></dt>
<dd><p>Given an openpyxl worksheet, returns the number of empty rows at the bottom,
the number of empty columns on the right, as well as the last used row and column.</p>
<p>This function iterates through the rows and columns from the bottom-right corner
and checks for non-empty values, then returns the last used row and column,
excluding the empty ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sheet</strong> (<em>openpyxl.worksheet.worksheet.Worksheet</em>) – The openpyxl worksheet object that contains the data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NamedTuple containing the number of empty rows and columns at the bottom,
and the last used row and column.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dqchecks.panacea.UsedArea" title="dqchecks.panacea.UsedArea">UsedArea</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the input is not a valid openpyxl worksheet.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.validate_input_data">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">validate_input_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.panacea.FormulaErrorSheetContext" title="dqchecks.panacea.FormulaErrorSheetContext"><span class="pre">FormulaErrorSheetContext</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.panacea.validate_input_data" title="Link to this definition">¶</a></dt>
<dd><p>Validates the input data and context to ensure they are in the expected format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>dict</em>) – The input error data.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#dqchecks.panacea.FormulaErrorSheetContext" title="dqchecks.panacea.FormulaErrorSheetContext"><em>FormulaErrorSheetContext</em></a>) – The context with error details.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If either the ‘input_data’ or ‘context’ are invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.panacea.validate_tabs_between_spreadsheets">
<span class="sig-prename descclassname"><span class="pre">dqchecks.panacea.</span></span><span class="sig-name descname"><span class="pre">validate_tabs_between_spreadsheets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spreadsheet1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spreadsheet2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#dqchecks.panacea.validate_tabs_between_spreadsheets" title="Link to this definition">¶</a></dt>
<dd><p>Compares the sheet names between two openpyxl workbook objects to check if they are identical.</p>
<p>This function compares sheet names in both workbooks, ensuring that they contain the same tabs
(ignoring order). If there are any missing tabs in either workbook,</p>
<blockquote>
<div><p>it will return False and provide</p>
</div></blockquote>
<p>details on which sheets are missing from each spreadsheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spreadsheet1</strong> (<em>openpyxl.workbook.workbook.Workbook</em>) – The first workbook object to compare.</p></li>
<li><p><strong>spreadsheet2</strong> (<em>openpyxl.workbook.workbook.Workbook</em>) – The second workbook object to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>“status”: “Ok” if both workbooks have the same sheet names, “Error” otherwise.</p></li>
<li><p>”description”: A general description of the comparison result.</p></li>
<li><p>”errors”: A dictionary containing detailed error messages about missing tabs.
If no errors, this will be an empty dictionary.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If either argument is not a valid openpyxl workbook object.</p></li>
<li><p><strong>InvalidFileException</strong> – If there is an issue with loading the workbook.</p></li>
<li><p><strong>Exception</strong> – For any unexpected errors during execution.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dqchecks.proteus">
<span id="dqchecks-proteus-module"></span><h2>dqchecks.proteus module<a class="headerlink" href="#module-dqchecks.proteus" title="Link to this heading">¶</a></h2>
<p>Proteus code</p>
</section>
<section id="module-dqchecks.transforms">
<span id="dqchecks-transforms-module"></span><h2>dqchecks.transforms module<a class="headerlink" href="#module-dqchecks.transforms" title="Link to this heading">¶</a></h2>
<p>Functions to transform data from Excel.
Main function being:</p>
<p>process_fout_sheets</p>
<dl class="py class">
<dt class="sig sig-object py" id="dqchecks.transforms.ProcessingContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">ProcessingContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">org_cd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submission_period_cd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_cd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_modified</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.ProcessingContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.transforms.ProcessingContext.last_modified">
<span class="sig-name descname"><span class="pre">last_modified</span></span><a class="headerlink" href="#dqchecks.transforms.ProcessingContext.last_modified" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.transforms.ProcessingContext.org_cd">
<span class="sig-name descname"><span class="pre">org_cd</span></span><a class="headerlink" href="#dqchecks.transforms.ProcessingContext.org_cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.transforms.ProcessingContext.process_cd">
<span class="sig-name descname"><span class="pre">process_cd</span></span><a class="headerlink" href="#dqchecks.transforms.ProcessingContext.process_cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.transforms.ProcessingContext.submission_period_cd">
<span class="sig-name descname"><span class="pre">submission_period_cd</span></span><a class="headerlink" href="#dqchecks.transforms.ProcessingContext.submission_period_cd" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dqchecks.transforms.ProcessingContext.template_version">
<span class="sig-name descname"><span class="pre">template_version</span></span><a class="headerlink" href="#dqchecks.transforms.ProcessingContext.template_version" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.clean_data">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">clean_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.clean_data" title="Link to this definition">¶</a></dt>
<dd><p>Drops rows with NaN values and checks if any dataframe is empty.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.extract_fout_sheets">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">extract_fout_sheets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout_patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.extract_fout_sheets" title="Link to this definition">¶</a></dt>
<dd><p>Extracts sheets from the workbook whose names match any of the given regex patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wb</strong> (<em>Workbook</em>) – The Excel workbook object.</p></li>
<li><p><strong>fout_patterns</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of regex patterns to match sheet names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of matching sheet names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no matching sheets are found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.is_valid_regex">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">is_valid_regex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#dqchecks.transforms.is_valid_regex" title="Link to this definition">¶</a></dt>
<dd><p>Check if a given string is a valid regex</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.process_df">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">process_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.transforms.ProcessingContext" title="dqchecks.transforms.ProcessingContext"><span class="pre">ProcessingContext</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.process_df" title="Link to this definition">¶</a></dt>
<dd><p>Processes a single dataframe by melting it and adding context columns.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.process_fout_sheets">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">process_fout_sheets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.transforms.ProcessingContext" title="dqchecks.transforms.ProcessingContext"><span class="pre">ProcessingContext</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout_patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.process_fout_sheets" title="Link to this definition">¶</a></dt>
<dd><p>Processes all sheets in the given Excel workbook that start with ‘<a href="#id17"><span class="problematic" id="id18">fOut_</span></a>’ and extracts
data into a pandas DataFrame. Each sheet is expected to have columns representing
observations for various periods, and the function performs a transformation to normalize
the data into a consistent format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wb</strong> (<em>openpyxl.workbook.workbook.Workbook</em>) – The openpyxl Workbook object
containing the data to process.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#dqchecks.transforms.ProcessingContext" title="dqchecks.transforms.ProcessingContext"><em>ProcessingContext</em></a>) – The context object containing the organization code,
submission period code, process code, template version,
and last modified timestamp.</p></li>
<li><p><strong>observation_patterns</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of regular expression patterns
used to match columns representing observation periods in the data.</p></li>
<li><p><strong>fout_patterns</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of regex patterns to match sheet names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A pandas DataFrame containing the processed data from all matching sheets,</dt><dd><p>with columns like ‘Organisation_Cd’, ‘Observation_Period_Cd’, ‘Measure_Value’,
and other related columns.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the input values are invalid, if no matching sheets are found,
    if no observation period columns are found, or if no valid data is found after
    dropping NaN rows.</p></li>
<li><p><strong>TypeError</strong> – If the provided workbook is not of the correct type
    (i.e., not an openpyxl Workbook).</p></li>
<li><p><strong>Exception</strong> – For any other unexpected errors.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p># Assuming ‘wb’ is a valid openpyxl Workbook and ‘context’
# is a valid ProcessingContext object
wb = openpyxl.load_workbook(“data.xlsx”)
context = ProcessingContext(</p>
<blockquote>
<div><p>org_cd=”ORG001”,
submission_period_cd=”2025Q1”,
process_cd=”PROCESS01”,
template_version=”v1.0”,
last_modified=datetime.datetime(2025, 3, 4, 10, 30)</p>
</div></blockquote>
<p>)
# Regex pattern to match observation period columns
observation_patterns = [r”^ObsPeriod_d+$”]</p>
<p># Call the function
processed_data = process_fout_sheets(wb, context, observation_patterns)</p>
<p># The result will be a DataFrame containing the processed data
print(processed_data.head())  # Prints the first few rows of the processed DataFrame</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.process_observation_columns">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">process_observation_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.process_observation_columns" title="Link to this definition">¶</a></dt>
<dd><p>Identifies and returns the observation period columns based on the provided patterns.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.read_sheets_data">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">read_sheets_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fout_sheets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.read_sheets_data" title="Link to this definition">¶</a></dt>
<dd><p>Reads data from the sheets into pandas DataFrames.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.validate_context">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">validate_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dqchecks.transforms.ProcessingContext" title="dqchecks.transforms.ProcessingContext"><span class="pre">ProcessingContext</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.validate_context" title="Link to this definition">¶</a></dt>
<dd><p>Validates the fields in the context object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.validate_observation_patterns">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">validate_observation_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.validate_observation_patterns" title="Link to this definition">¶</a></dt>
<dd><p>Validates the observation patterns argument.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.transforms.validate_workbook">
<span class="sig-prename descclassname"><span class="pre">dqchecks.transforms.</span></span><span class="sig-name descname"><span class="pre">validate_workbook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Workbook</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dqchecks.transforms.validate_workbook" title="Link to this definition">¶</a></dt>
<dd><p>Validates if the provided workbook is an instance of openpyxl Workbook.</p>
</dd></dl>

</section>
<section id="module-dqchecks.utils">
<span id="dqchecks-utils-module"></span><h2>dqchecks.utils module<a class="headerlink" href="#module-dqchecks.utils" title="Link to this heading">¶</a></h2>
<p>Collection of helper functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="dqchecks.utils.simple_hdfs_ls">
<span class="sig-prename descclassname"><span class="pre">dqchecks.utils.</span></span><span class="sig-name descname"><span class="pre">simple_hdfs_ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#dqchecks.utils.simple_hdfs_ls" title="Link to this definition">¶</a></dt>
<dd><p>List files in an HDFS directory and retrieve their last modification time.</p>
<p>This function interacts with the Hadoop Distributed File System (HDFS) to list the files in a
specified directory, along with their last modification timestamp. The function uses PySpark’s
SparkSession to connect to the HDFS and retrieve file metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – The HDFS path to the directory whose files are to be listed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of dictionaries where each dictionary contains the file path (‘name’) and</dt><dd><p>the last modification time (‘last_modified’) of each file in the specified HDFS
directory. The ‘last_modified’ time is converted to a human-readable datetime format.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>file_info = simple_hdfs_ls(“hdfs://path/to/directory”)
for file in file_info:</p>
<blockquote>
<div><p>print(f”File: {file[‘name’]}, Last Modified: {file[‘last_modified’]}”)</p>
</div></blockquote>
</dd></dl>

</section>
<section id="module-dqchecks">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dqchecks" title="Link to this heading">¶</a></h2>
<p>Main entry point into the dqchecks package</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">dqchecks</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, ofwat.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/dqchecks.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>